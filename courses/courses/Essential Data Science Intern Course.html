<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Courses | Skill Up for Internships with Internadda</title>
    <meta name="description" content="Browse Internadda's free courses in Data Science, AI, Web Dev, Cybersecurity, and more. Gain practical skills needed for top internships.">
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Your Main Stylesheet (Assuming this contains styles for header, footer, cards, etc.) -->
    <link rel="stylesheet" href="../style.css">

    <!-- Inline Styles to ensure Modal/Dashboard looks correct if external styles are missing -->
    <style>
        :root {
            --primary: #2b6cb0;
            --secondary: #9f7aea;
            --dark: #2d3748;
            --light: #f7fafc;
            --white: #ffffff;
            --gray: #718096;
        }

        /* Essential Modal/Dashboard Styles (from previous snippet + enhancements) */
        .modal {
            display: none; 
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow: auto;
        }
        .modal.active { display: flex; }
        .modal-content {
            background-color: var(--white);
            padding: 30px;
            border-radius: 12px;
            max-width: 450px;
            width: 100%;
            position: relative;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .close-btn { color: var(--gray); font-size: 28px; font-weight: bold; position: absolute; top: 10px; right: 15px; cursor: pointer; }
        .auth-section { display: none; }
        .auth-section.active { display: block; }
        .auth-title { text-align: center; margin-bottom: 20px; color: var(--dark); }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-weight: 500; margin-bottom: 5px; }
        .form-group input, .form-group select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; }
        .btn-primary, .btn-google { width: 100%; margin-top: 10px; }
        .separator { text-align: center; margin: 20px 0; }
        .separator span { background: var(--white); padding: 0 10px; color: var(--gray); font-size: 14px; }
        .toggle-auth { text-align: center; margin-top: 20px; font-size: 15px; }
        
        /* Dashboard Tabs */
        .profile-tabs { display: flex; justify-content: space-between; border-bottom: 2px solid #e2e8f0; margin-bottom: 20px; }
        .tab-btn { flex-grow: 1; padding: 10px 0; background: none; border: none; cursor: pointer; font-weight: 600; color: var(--gray); border-bottom: 3px solid transparent; transition: all 0.3s; }
        .tab-btn.active { color: var(--primary); border-bottom: 3px solid var(--primary); }
        .tab-content.hidden { display: none; }

        /* Profile Card Styles */
        .user-info-profile { display: flex; align-items: center; gap: 20px; margin-bottom: 30px; }
        .user-avatar { width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 3px solid var(--primary); }
        .user-profile-details h2 { font-size: 1.8rem; margin-bottom: 5px; }
        .profile-details { margin-top: 20px; padding: 15px; background: var(--light); border-radius: 8px; }
        .profile-info-item { margin-bottom: 10px; font-size: 1.1rem; }
        #editProfileBtn, #saveProfileBtn { margin-top: 15px; width: 100%; }

        /* Courses Section overrides */
        .course-card {
            display: block;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            background-color: var(--white);
        }
        .course-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        .course-image img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }
        .course-content {
            padding: 20px;
        }
        .badge.free {
            background-color: var(--success);
            color: var(--white);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 700;
        }
        .course-price {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        .original-price {
            text-decoration: line-through;
            color: var(--gray);
            font-size: 0.9rem;
        }
    </style>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3ZZ3HGFM3Q"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3ZZ3HGFM3Q');
    </script>
</head>

<body>
    <header>
        <div class="container header-container">
            <a href="/" class="logo">
                <img src="../images/logo.jpg" alt="InternAdda Logo" class="logo-img">
                <span class="logo-text">InternAdda</span>
            </a>

            <nav class="nav-menu">
                <a href="/index.html" class="nav-link">Home</a>
                <a href="/courses/course.html" class="nav-link">Courses</a>
                <a href="/intern/internship.html" class="nav-link">Internships</a>
                <a href="/jobs.html" class="nav-link">Jobs</a>
                <a href="/about.html" class="nav-link">About</a>
                <div class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle">Community <i class="fas fa-chevron-down dropdown-arrow"></i></a>
                    <div class="dropdown-content">
                        <a href="/community/join.html" class="dropdown-link">Join Community</a>
                        <a href="/community/partners.html" class="dropdown-link">Partners</a>
                        <a href="/blog/index.html" class="dropdown-link">Blog</a>
                        <a href="/community/academy.html" class="dropdown-link">Offline Academy</a>
                    </div>
                </div>

                <!-- Mobile links, consolidated -->
                <a href="/contact.html" class="nav-link mobile-only-link">Contact</a>
                <a href="/terms.html" class="nav-link mobile-only-link">Terms</a>
                <a href="/refund.html" class="nav-link mobile-only-link">Refund</a>
                
                <!-- Mobile Auth Actions (using data-action for global listener) -->
                <div class="nav-actions-mobile">
                    <div class="user-profile hidden" id="userProfileMobile">
                        <img src="../images/no_image.png" alt="User Avatar" class="user-avatar-header" id="userAvatarHeaderMobile" style="display:inline-block; vertical-align:middle; width:40px; height:40px; border-radius:50%; margin-right:8px;">
                        <button data-action="logout" class="btn btn-outline" style="width: 100%;">Sign Out</button>
                    </div>
                    <div id="authButtonsMobile" style="width: 100%; display: flex; gap: 10px; justify-content: center;">
                        <a href="#" class="btn btn-outline" data-action="login">Log in</a>
                        <a href="#" class="btn btn-primary" data-action="signup">Sign up</a>
                    </div>
                </div>
            </nav>

            <div class="header-actions">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" class="search-input" placeholder="Search for courses...">
                </div>

                <div id="authButtons">
                    <a href="#" class="btn btn-outline" data-action="login">Log in</a>
                    <a href="#" class="btn btn-primary" data-action="signup">Sign up</a>
                </div>

                <div class="user-profile hidden" id="userProfile" data-action="profile-dropdown">
                    <img src="../images/no_image.png" alt="User Avatar" class="user-avatar-header" id="userAvatarHeader">
                    <span id="userNameHeader"></span>
                    <div class="dropdown-menu hidden" id="userDropdown">
                        <button data-action="dashboard">My Profile</button>
                        <button data-action="logout">Sign Out</button>
                    </div>
                </div>
            </div>

            <button class="hamburger-menu" id="hamburgerMenu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
        <div id="searchResults" class="search-results-container container hidden"></div>
    </header>

    <main>
        <section class="courses">
            <div class="container">
                <div class="courses-header">
                    <h2 class="section-title">All Courses</h2>
                </div>

                <div class="courses-grid" id="coursesGrid">

                    <!-- Course Card 1 -->
                    <a href="courses/Essential Data Science Intern Course.html"
                        class="course-card"
                        style="text-decoration:none; color:inherit;">
                        <div class="course-image">
                            <img src="../images/Essential Data Science Intern Course.png"
                                alt="Essential Data Science Intern Course" onerror="this.onerror=null;this.src='https://placehold.co/400x180/2b6cb0/ffffff?text=Data+Science'">
                        </div>
                        <div class="course-content">
                            <h3 class="course-title">Data Science Intern Course</h3>
                            <p class="course-author">Instructed by Lucky Kumar</p>
                            <div class="course-rating">
                                <div class="rating-stars">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star-half-alt"></i>
                                </div>
                                <span class="rating-value">4.9</span>
                            </div>
                            <div class="course-duration">
                                <i class="far fa-clock"></i> Average Duration: 27 mins
                            </div>
                            <div class="course-price">
                                <span class="original-price">â‚¹1,999</span>
                                <span class="badge free">FREE</span>
                            </div>
                        </div>
                    </a>

                    <!-- Course Card 2 -->
                    <a href="courses/Generative-AI-Prompt-Engineering-Masterclass.html"
                        class="course-card"
                        style="text-decoration:none; color:inherit;">
                        <div class="course-image">
                            <img src="../images/Generative-AI-Prompt-Engineering-Masterclass.png"
                                alt="Generative AI & Prompt Engineering Masterclass" onerror="this.onerror=null;this.src='https://placehold.co/400x180/9f7aea/ffffff?text=Gen+AI+Prompting'">
                        </div>
                        <div class="course-content">
                            <h3 class="course-title">Generative AI & Prompt Engineering</h3>
                            <p class="course-author">Instructed by Lucky Kumar</p>
                            <div class="course-rating">
                                <div class="rating-stars">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star-half-alt"></i>
                                </div>
                                <span class="rating-value">4.7</span>
                            </div>
                            <div class="course-duration">
                                <i class="far fa-clock"></i> Average Duration: 30 mins
                            </div>
                            <div class="course-price">
                                <span class="original-price">â‚¹2,999</span>
                                <span class="badge free">FREE</span>
                            </div>
                        </div>
                    </a>

                    <!-- Course Card 3 -->
                    <a href="courses/Ethical-Hacking-Mastery.html"
                        class="course-card"
                        style="text-decoration:none; color:inherit;">
                        <div class="course-image">
                            <img src="../images/Ethical-Hacking-Mastery.png"
                                alt="Ethical Hacking Mastery" onerror="this.onerror=null;this.src='https://placehold.co/400x180/38a169/ffffff?text=Ethical+Hacking'">
                        </div>
                        <div class="course-content">
                            <h3 class="course-title">Ethical Hacking Mastery</h3>
                            <p class="course-author">Instructed by Lucky Kumar</p>
                            <div class="course-rating">
                                <div class="rating-stars">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star-half-alt"></i>
                                </div>
                                <span class="rating-value">4.8</span>
                            </div>
                            <div class="course-duration">
                                <i class="far fa-clock"></i> Average Duration: 29 mins
                            </div>
                            <div class="course-price">
                                <span class="original-price">â‚¹4,999</span>
                                <span class="badge free">FREE</span>
                            </div>
                        </div>
                    </a>

                    <!-- Course Card 4 -->
                    <a href="courses/Python-Essentials-for-All.html"
                        class="course-card"
                        style="text-decoration:none; color:inherit;">
                        <div class="course-image">
                            <img src="../images/Python-Essentials-for-All.png"
                                alt="Python Essentials for All" onerror="this.onerror=null;this.src='https://placehold.co/400x180/ed8936/ffffff?text=Python+Essentials'">
                        </div>
                        <div class="course-content">
                            <h3 class="course-title">Python Essentials for All</h3>
                            <p class="course-author">Instructed by Lucky Kumar</p>
                            <div class="course-rating">
                                <div class="rating-stars">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star-half-alt"></i>
                                </div>
                                <span class="rating-value">4.8</span>
                            </div>
                            <div class="course-duration">
                                <i class="far fa-clock"></i> Average Duration: 28 mins
                            </div>
                            <div class="course-price">
                                <span class="original-price">â‚¹1,999</span>
                                <span class="badge free">FREE</span>
                            </div>
                        </div>
                    </a>

                    <!-- Course Card 5 -->
                    <a href="courses/Cloud-DevOps-Essentials.html"
                        class="course-card"
                        style="text-decoration:none; color:inherit;">
                        <div class="course-image">
                            <img src="../images/Cloud-DevOps-Essentials.png"
                                alt="Cloud & DevOps Essentials" onerror="this.onerror=null;this.src='https://placehold.co/400x180/718096/ffffff?text=Cloud+DevOps'">
                        </div>
                        <div class="course-content">
                            <h3 class="course-title">Cloud & DevOps Essentials</h3>
                            <p class="course-author">Instructed by Lucky Kumar</p>
                            <div class="course-rating">
                                <div class="rating-stars">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star-half-alt"></i>
                                </div>
                                <span class="rating-value">4.8</span>
                            </div>
                            <div class="course-duration">
                                <i class="far fa-clock"></i> Average Duration: 26 mins
                            </div>
                            <div class="course-price">
                                <span class="original-price">â‚¹2,999</span>
                                <span class="badge free">FREE</span>
                            </div>
                        </div>
                    </a>
                    </div> 
                </div>
        </section>

        <section class="cta-section">
            <div class="container">
                <h2 class="cta-title">Start Your Career Journey Today</h2>
                <p class="cta-description">Join thousands of students who have transformed their careers through Internadda's learn, intern, and earn model.</p>
                <div class="cta-buttons">
                    <button class="btn btn-light btn-lg" onclick="window.location.href='/intern/internship.html'">Get Started</button>
                    <button class="btn btn-transparent btn-lg" onclick="window.location.href='/courses/course.html'">Browse Courses</button>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <div class="footer-logo">Internadda</div>
                    <p class="footer-description">Transforming careers through learning, interning, and earning opportunities.</p>
                    <div class="social-links">
                        <a href="https://www.linkedin.com/company/internadda-india" target="_blank" class="social-link" aria-label="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://www.youtube.com/@theinternadda" target="_blank" class="social-link" aria-label="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="https://www.instagram.com/internadda.india" target="_blank" class="social-link" aria-label="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                    </div>
                </div>

                <div class="footer-links-column">
                    <h3 class="footer-links-title">Learn</h3>
                    <ul class="footer-links">
                        <li><a href="/courses/course.html">Browse Courses</a></li>
                        <li><a href="/courses/course.html">Free Courses</a></li>
                        <li><a href="#">Paid Courses</a></li>
                        <li><a href="#">Become an Instructor</a></li>
                    </ul>
                </div>

                <div class="footer-links-column">
                    <h3 class="footer-links-title">Intern</h3>
                    <ul class="footer-links">
                        <li><a href="/intern/internship.html">Find Internships</a></li>
                        <li><a href="#">For Companies</a></li>
                        <li><a href="#">Success Stories</a></li>
                        <li><a href="#">Career Coaching</a></li>
                    </ul>
                </div>

                <div class="footer-links-column">
                    <h3 class="footer-links-title">Community</h3>
                    <ul class="footer-links">
                        <li><a href="/community/join.html">Join Community</a></li>
                        <li><a href="/community/partners.html">Partners</a></li>
                        <li><a href="/blog/index.html">Blog</a></li>
                        <li><a href="/community/academy.html">Offline Academy</a></li>
                    </ul>
                </div>

                <div class="footer-links-column">
                    <h3 class="footer-links-title">InternAdda</h3>
                    <ul class="footer-links">
                        <li><a href="/about.html">About Us</a></li>
                        <li><a href="/contact.html">Contact Us</a></li>
                        <li><a href="/terms.html">Terms & Conditions</a></li>
                        <li><a href="/refund.html">Refund Policy</a></li>
                    </ul>
                </div>

                <div class="footer-links-column">
                    <h3 class="footer-links-title">More</h3>
                    <ul class="footer-links">
                        <li><a href="#">Affiliate Program</a></li>
                        <li><a href="#">FAQ</a></li>
                        <li><a href="#">QnA</a></li>
                        <li><a href="#">Daily Challenges</a></li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p>Â© 2025 Internadda. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Auth Modal Structure (hidden by default) -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" data-action="close">&times;</span>

            <!-- Login Section -->
            <div id="loginSection" class="auth-section">
                <div class="auth-notification">
                    <i class="fas fa-lock"></i> <strong>Log in Required:</strong> Log in to take courses, track progress, and apply for internships.
                </div>
                <h2 class="auth-title">Welcome Back</h2>
                <div class="loading hidden" id="loginLoading">
                    <div class="spinner"></div>
                    <span>Signing in...</span>
                </div>
                <div id="loginError" class="error"></div>

                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" placeholder="Enter your email" required>
                </div>

                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password" required>
                </div>

                <button class="btn btn-primary" id="emailLoginBtn">Sign In</button>
                <div class="separator"><span>OR</span></div>
                <button class="btn btn-google" id="googleLoginBtn"><i class="fab fa-google"></i> Continue with Google</button>

                <div class="toggle-auth">
                    <span>Don't have an account?</span> <a href="#" data-action="show-signup">Sign up</a>
                </div>
            </div>

            <!-- Signup Section -->
            <div id="signupSection" class="auth-section">
                <h2 class="auth-title">Create Account</h2>
                <div class="loading hidden" id="signupLoading">
                    <div class="spinner"></div>
                    <span>Creating account...</span>
                </div>
                <div id="signupError" class="error"></div>

                <div class="form-group">
                    <label for="signupEmail">Email</label>
                    <input type="email" id="signupEmail" placeholder="Enter your email" required>
                </div>

                <div class="form-group">
                    <label for="signupPassword">Password</label>
                    <input type="password" id="signupPassword" placeholder="Create a password (6+ characters)" required>
                </div>

                <button class="btn btn-primary" id="emailSignupBtn">Create Account</button>
                <div class="separator"><span>OR</span></div>
                <button class="btn btn-google" id="googleSignupBtn"><i class="fab fa-google"></i> Sign up with Google</button>

                <div class="toggle-auth">
                    <span>Already have an account?</span> <a href="#" data-action="show-login">Sign in</a>
                </div>
            </div>

            <!-- Dashboard/Profile Section -->
            <div id="dashboardSection" class="auth-section">
                <h2 class="auth-title">My Dashboard</h2>
                <div class="dashboard-content">
                    <div class="profile-tabs">
                        <button class="tab-btn active" data-tab="profile">Profile</button>
                        <button class="tab-btn" data-tab="courses">Courses</button>
                        <button class="tab-btn" data-tab="internships">Internships</button>
                    </div>

                    <div id="profileTabContent" class="tab-content active">
                        <div id="profileDisplaySection">
                            <div class="user-info-profile">
                                <div class="profile-avatar-display">
                                    <img id="userAvatarDashboard" class="user-avatar" src="../images/no_image.png" alt="User Avatar">
                                </div>
                                <div class="user-profile-details">
                                    <h2 id="userNameDashboard">Guest User</h2>
                                    <p id="userEmailDashboard"></p>
                                </div>
                            </div>
                            <div class="profile-details">
                                <h3 class="section-title-small">Profile Information</h3>
                                <div class="profile-info-item">
                                    <strong>Gender:</strong> <span id="profileGenderDisplay">Not specified</span>
                                </div>
                                <div class="profile-info-item">
                                    <strong>Interested Domain:</strong> <span id="profileDomainDisplay">Not specified</span>
                                </div>
                            </div>
                            <button class="btn btn-primary" id="shareProfileBtn" style="width: 100%; margin-top: 20px;"><i class="fas fa-share-alt" style="margin-right: 8px;"></i> Share My Profile</button>
                            <button class="btn btn-outline" data-action="edit-profile">Edit Profile</button>
                        </div>

                        <div id="profileEditSection" class="hidden">
                            <div id="profileEditError" class="error hidden" style="color: var(--warning);"></div>
                            <div class="profile-avatar-display" style="text-align: center; margin-bottom: 20px;">
                                <img id="userAvatarPreview" class="user-avatar" src="../images/no_image.png" alt="User Avatar Preview">
                                <label for="profileImageInput" class="file-upload-label" style="display: block; margin-top: 10px; color: var(--primary); cursor: pointer;">
                                    <i class="fas fa-upload"></i> Upload Image
                                </label>
                                <input type="file" id="profileImageInput" accept="image/*" class="hidden">
                                <p class="profile-avatar-hint" style="margin-top: 5px; font-size: 0.85rem; color: #f56565;">*Image upload is for demo only; file storage is not active.</p>
                            </div>
                            <div class="form-group">
                                <label for="profileName">Full Name</label>
                                <input type="text" id="profileName" placeholder="Enter your full name">
                            </div>
                            <div class="form-group">
                                <label for="profileGender">Gender</label>
                                <select id="profileGender">
                                    <option value="">Select Gender</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="interestedDomain">Interested Domain</label>
                                <select id="interestedDomain">
                                    <option value="">Select Domain</option>
                                    <option value="Web Development">Web Development</option>
                                    <option value="Data Science & AI">Data Science & AI</option>
                                    <option value="Digital Marketing">Digital Marketing</option>
                                    <option value="UI/UX Design">UI/UX Design</option>
                                </select>
                            </div>
                            <button class="btn btn-primary" data-action="save-profile">Save Profile</button>
                        </div>
                    </div>

                    <div id="coursesTabContent" class="tab-content hidden">
                        <h3 class="section-title-small">ðŸ“š Enrolled Courses & Certificates</h3>
                        <p style="color: var(--gray); margin-bottom: 20px;">Track your progress and access completion certificates here.</p>
                        <div id="coursesListContainer" class="user-data-list">
                            <p style="text-align: center; padding: 20px;">You are not enrolled in any courses yet. <a href="/courses/course.html">Browse now</a>.</p>
                        </div>
                    </div>

                    <div id="internshipsTabContent" class="tab-content hidden">
                        <h3 class="section-title-small">ðŸ’¼ Internship Application History</h3>
                        <p style="color: var(--gray); margin-bottom: 20px;">View your exam results and application status for different domains.</p>
                        <div id="internshipsListContainer" class="user-data-list">
                            <p style="text-align: center; padding: 20px;">No application history found. <a href="/intern/internship.html">Find an Internship</a>.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase Imports and Main Script Logic -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, collection, query, where, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Enable debug logging for Firebase
        setLogLevel('Debug');

        // --- 1. Canvas Global Variables and Firebase Setup ---
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let db = null;
        let auth = null;
        let userId = null;
        let unsubscribeUser = null;

        const userData = {
            name: "Guest User",
            email: "",
            avatar: "../images/no_image.png",
            gender: "",
            domain: ""
        };

        // --- 2. DOM Element Mapping ---
        const DOMElements = {
            // Navigation
            navMenu: document.querySelector('.nav-menu'),
            hamburgerMenu: document.getElementById('hamburgerMenu'),

            // Auth Header States
            authButtons: document.getElementById('authButtons'),
            authButtonsMobile: document.getElementById('authButtonsMobile'),
            userProfile: document.getElementById('userProfile'),
            userProfileMobile: document.getElementById('userProfileMobile'),
            userDropdown: document.getElementById('userDropdown'),
            
            // Modal Sections
            authModal: document.getElementById('authModal'),
            loginSection: document.getElementById('loginSection'),
            signupSection: document.getElementById('signupSection'),
            dashboardSection: document.getElementById('dashboardSection'),

            // Dashboard
            tabButtons: document.querySelectorAll('#dashboardSection .tab-btn'),
            tabContents: document.querySelectorAll('#dashboardSection .tab-content'),
            profileDisplaySection: document.getElementById('profileDisplaySection'),
            profileEditSection: document.getElementById('profileEditSection'),
            
            // Input Fields
            loginEmail: document.getElementById('loginEmail'),
            loginPassword: document.getElementById('loginPassword'),
            signupEmail: document.getElementById('signupEmail'),
            signupPassword: document.getElementById('signupPassword'),
            profileName: document.getElementById('profileName'),
            profileGender: document.getElementById('profileGender'),
            interestedDomain: document.getElementById('interestedDomain'),
            
            // Error/Loading
            loginError: document.getElementById('loginError'),
            signupError: document.getElementById('signupError'),
            loginLoading: document.getElementById('loginLoading'),
            signupLoading: document.getElementById('signupLoading'),
        };

        // --- 3. Core Utility Functions ---

        const closeHamburgerMenu = () => {
            DOMElements.navMenu?.classList.remove('active');
            DOMElements.hamburgerMenu?.classList.remove('active');
        };

        const showError = (element, message) => {
            element.textContent = message;
            element.classList.remove('hidden');
            setTimeout(() => element.classList.add('hidden'), 5000);
        };

        const startLoading = (element) => element?.classList.remove('hidden');
        const stopLoading = (element) => element?.classList.add('hidden');

        const openModal = (section) => {
            DOMElements.authModal.classList.add('active');
            document.body.style.overflow = 'hidden';
            closeHamburgerMenu();
            showSection(section);
        };

        const closeModal = () => {
            DOMElements.authModal.classList.remove('active');
            document.body.style.overflow = '';
            // Default to login section on close
            showSection(DOMElements.loginSection);
        };
        
        const showSection = (sectionElement) => {
            document.querySelectorAll('.auth-section').forEach(sec => sec.classList.remove('active'));
            if (sectionElement) {
                sectionElement.classList.add('active');
                if (sectionElement === DOMElements.dashboardSection) {
                    activateDashboardTab('profile');
                    updateProfileDisplay();
                }
            }
        };

        // --- 4. Profile & State Management (Client-side display logic) ---

        const updateHeaderState = (user) => {
            const loggedIn = !!user;
            
            if (loggedIn) {
                DOMElements.authButtons.classList.add('hidden');
                DOMElements.authButtonsMobile.classList.add('hidden');
                DOMElements.userProfile.classList.remove('hidden');
                DOMElements.userProfileMobile.classList.remove('hidden');
            } else {
                DOMElements.authButtons.classList.remove('hidden');
                DOMElements.authButtonsMobile.classList.remove('hidden');
                DOMElements.userProfile.classList.add('hidden');
                DOMElements.userProfileMobile.classList.add('hidden');
                
                // Clear state on logout
                userData.name = "Guest User";
                userData.email = "";
            }

            // Update Header User Info (Desktop & Mobile)
            document.getElementById('userNameHeader').textContent = userData.name.split(' ')[0] || 'User';
            document.getElementById('userAvatarHeader').src = userData.avatar;
            document.getElementById('userAvatarHeaderMobile').src = userData.avatar;
            document.getElementById('userEmailDashboard').textContent = userData.email;
        };
        
        const updateProfileDisplay = () => {
            document.getElementById('userNameDashboard').textContent = userData.name;
            document.getElementById('userAvatarDashboard').src = userData.avatar;
            document.getElementById('profileGenderDisplay').textContent = userData.gender || 'Not specified';
            document.getElementById('profileDomainDisplay').textContent = userData.domain || 'Not specified';
            DOMElements.profileDisplaySection.classList.remove('hidden');
            DOMElements.profileEditSection.classList.add('hidden');
        };
        
        const loadProfileForEdit = () => {
            DOMElements.profileName.value = userData.name;
            DOMElements.profileGender.value = userData.gender || '';
            DOMElements.interestedDomain.value = userData.domain || '';
            document.getElementById('userAvatarPreview').src = userData.avatar;
            DOMElements.profileDisplaySection.classList.add('hidden');
            DOMElements.profileEditSection.classList.remove('hidden');
        };

        const activateDashboardTab = (tabName) => {
            DOMElements.tabButtons.forEach(btn => {
                if (btn.dataset.tab === tabName) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            DOMElements.tabContents.forEach(content => {
                if (content.id === `${tabName}TabContent`) {
                    content.classList.remove('hidden');
                } else {
                    content.classList.add('hidden');
                }
            });
        };
        
        // --- 5. Firebase Authentication Functions ---

        const fetchUserData = (uid) => {
            if (unsubscribeUser) unsubscribeUser();
            
            if (db) {
                const userDocRef = doc(db, `artifacts/${appId}/users/${uid}/profile/info`);
                
                // Real-time listener for user profile data
                unsubscribeUser = onSnapshot(userDocRef, (docSnap) => {
                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        userData.name = data.name || auth.currentUser.displayName || 'Intern User';
                        userData.avatar = data.avatar || auth.currentUser.photoURL || '../images/no_image.png';
                        userData.gender = data.gender || '';
                        userData.domain = data.domain || '';
                    } else {
                        // Create initial document if it doesn't exist
                        setDoc(userDocRef, { 
                            name: auth.currentUser.displayName || 'Intern User',
                            email: auth.currentUser.email || 'N/A',
                            createdAt: new Date().toISOString()
                        }, { merge: true });
                        userData.name = auth.currentUser.displayName || 'Intern User';
                    }
                    userData.email = auth.currentUser.email || 'N/A';
                    updateHeaderState(auth.currentUser);
                    if (DOMElements.dashboardSection.classList.contains('active')) {
                        updateProfileDisplay();
                    }
                }, (error) => {
                    console.error("Error fetching user data:", error);
                });
            }
        };

        const handleAuthError = (action, error) => {
            const errorElement = action === 'login' ? DOMElements.loginError : DOMElements.signupError;
            const loadingElement = action === 'login' ? DOMElements.loginLoading : DOMElements.signupLoading;
            stopLoading(loadingElement);
            console.error(`${action} failed:`, error);
            showError(errorElement, `Authentication failed: ${error.message.replace('Firebase: ', '')}`);
        };

        const emailSignup = async () => {
            startLoading(DOMElements.signupLoading);
            try {
                const email = DOMElements.signupEmail.value;
                const password = DOMElements.signupPassword.value;
                await createUserWithEmailAndPassword(auth, email, password);
                // AuthStateChanged listener handles the rest
                closeModal();
            } catch (error) {
                handleAuthError('signup', error);
            }
        };

        const emailLogin = async () => {
            startLoading(DOMElements.loginLoading);
            try {
                const email = DOMElements.loginEmail.value;
                const password = DOMElements.loginPassword.value;
                await signInWithEmailAndPassword(auth, email, password);
                // AuthStateChanged listener handles the rest
                closeModal();
            } catch (error) {
                handleAuthError('login', error);
            }
        };

        const handleLogout = async () => {
            try {
                if (unsubscribeUser) unsubscribeUser();
                await signOut(auth);
                updateHeaderState(null);
                closeModal();
            } catch (error) {
                console.error("Logout failed:", error);
            }
        };

        const saveProfileData = async () => {
            if (!auth.currentUser || !db) return;

            const name = DOMElements.profileName.value.trim();
            const gender = DOMElements.profileGender.value;
            const domain = DOMElements.interestedDomain.value;
            
            if (name.length < 3) {
                showError(document.getElementById('profileEditError'), "Name must be at least 3 characters.");
                return;
            }

            try {
                const userDocRef = doc(db, `artifacts/${appId}/users/${auth.currentUser.uid}/profile/info`);
                await setDoc(userDocRef, { name, gender, domain }, { merge: true });
                
                // Update local state and display
                userData.name = name;
                userData.gender = gender;
                userData.domain = domain;

                updateProfileDisplay();
                updateHeaderState(auth.currentUser); // Update header with new name
            } catch (error) {
                showError(document.getElementById('profileEditError'), `Failed to save: ${error.message}`);
                console.error("Error saving profile:", error);
            }
        };

        // --- 6. Initialization and Event Setup ---

        const initApp = async () => {
            if (firebaseConfig) {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
            } else {
                console.error("Firebase configuration is missing.");
                return;
            }

            // Authentication listener
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    userId = user.uid;
                    fetchUserData(user.uid);
                } else {
                    // Initial sign-in logic for Canvas environment
                    if (initialAuthToken) {
                        try {
                            await signInWithCustomToken(auth, initialAuthToken);
                        } catch (e) {
                            console.error("Custom token sign-in failed. Signing in anonymously.", e);
                            await signInAnonymously(auth);
                        }
                    } else {
                        // Fallback to anonymous for unauthenticated users in a hosted environment
                        await signInAnonymously(auth);
                    }
                    updateHeaderState(auth.currentUser);
                }
            });

            // Global Click Handler using event delegation
            document.addEventListener('click', (e) => {
                const target = e.target.closest('[data-action]');
                
                // Handle modal backdrop click
                if (e.target === DOMElements.authModal) {
                    closeModal();
                }

                // Handle dropdown close
                if (!e.target.closest('#userProfile')) {
                    DOMElements.userDropdown?.classList.add('hidden');
                }

                if (!target) return;
                e.preventDefault();

                switch (target.dataset.action) {
                    case 'login':
                    case 'show-login':
                        showSection(DOMElements.loginSection);
                        openModal(DOMElements.loginSection);
                        break;
                    case 'signup':
                    case 'show-signup':
                        showSection(DOMElements.signupSection);
                        openModal(DOMElements.signupSection);
                        break;
                    case 'dashboard':
                        // If user is logged in, show dashboard, otherwise prompt login
                        if (auth.currentUser?.uid) {
                            openModal(DOMElements.dashboardSection);
                        } else {
                            openModal(DOMElements.loginSection);
                        }
                        DOMElements.userDropdown?.classList.add('hidden');
                        break;
                    case 'close':
                        closeModal();
                        break;
                    case 'profile-dropdown':
                        DOMElements.userDropdown?.classList.toggle('hidden');
                        break;
                    case 'logout':
                        handleLogout();
                        break;
                    case 'edit-profile':
                        loadProfileForEdit();
                        break;
                    case 'save-profile':
                        saveProfileData();
                        break;
                }
            });

            // Specific Button Listeners
            document.getElementById('emailSignupBtn')?.addEventListener('click', emailSignup);
            document.getElementById('emailLoginBtn')?.addEventListener('click', emailLogin);
            
            // Dashboard Tab Switching
            DOMElements.tabButtons.forEach(button => {
                button.addEventListener('click', () => activateDashboardTab(button.dataset.tab));
            });
        };

        initApp();
    </script>
</body>
</html>
